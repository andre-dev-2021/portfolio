---
title: "Regressão Linear: visualizando a relação entre valores"
description: "Conheça a base para entender como a IA faz previsões."
author: "André Pereira"
date: "11/10/2025"
categories:
    - machine learning
    - análise preditiva
    - IA
    - plotly
    - numpy
    - regressão linear
image: machine_learning.jpg
---

## O que é uma regressão linear?

A **regressão linear** é uma técnica estatística usada para modelar a relação entre uma variável dependente (ou resposta) e uma ou mais variáveis independentes (ou preditoras).

Ela permite **prever valores desconhecidos da variável** dependente com base nos valores conhecidos das variáveis independentes, assumindo que essa relação pode ser representada por uma equação linear.

Essa técnica é amplamente utilizada em *machine learning* e em análise de dados para fazer previsões e **identificar tendências** lineares entre variáveis.

Fonte: [AWS - O que é regressão linear?](https://aws.amazon.com/pt/what-is/linear-regression/)

## Como calcular a regressão linear?

A fórmula para a **regressão linear simples é** $Y = b_0 + b_1X$ onde:

* $X$: variável independente (valor usado para prever os resultados);
* $Y$: variável dependente (valor que queremos prever);
* $b_0$: intercepto, o valor de $Y$ quando $X = 0$.
* $b_1$: coeficiente angular (ou inclinação da reta), que indica a intensidade e direção da relação linear entre $X$ e $Y$.

A forma matricial da regressão linear é dada por: $b = (X^{T}X)^{-1}X^Ty$

onde $b$ contém os coeficientes $[b_0, b_1]$

## Exemplo: relação entre anos de estudo e salário

Como exemplo vamos utilizar duas *arrays*:

**X** para representar os anos de estudo e **y** para salários.

```python
import numpy as np

X = np.array([5, 7, 9, 10, 12, 13, 14, 16, 18, 20])
y = np.array([1500, 1800, 2200, 2600, 3100, 3500, 4000, 4800, 5500, 6200])
```

### 1. Ajustando os dados

Para calcular os coeficientes, precisamos adicionar uma coluna de 1s a X, que representa o intercepto da regressão.

```python

X = np.array([[1, i] for i in X])
```

### 2. Calculando os coeficientes

Aplicamos a fórmula matricial da regressão linear.

```python
res = np.dot(np.transpose(X), X)
res = np.dot(np.linalg.inv(res), np.transpose(X))
res = np.dot(res, y)

b0, b1 = res
```

### 3. Calculando os valores previstos

Com os coeficientes em mãos, podemos estimar os valores de **Y** (salário previsto):

```python
Y = [b0 + b1 * i for i in X[:, 1]]
```

Vamos visualizar o resultado:

```{python}

#| label: plot_regressao
#| fig_cap: Gráfico com regressão linear.

import plotly.graph_objects as go
import numpy as np

# Ajustando os dados
X = np.array([5, 7, 9, 10, 12, 13, 14, 16, 18, 20])
y = np.array([1500, 1800, 2200, 2600, 3100, 3500, 4000, 4800, 5500, 6200])

# Calculando os coeficientes
def coef(X, y):
    X = np.array([[1, i] for i in X])
    res = np.dot(np.transpose(X), X)
    res = np.dot(np.linalg.inv(res), np.transpose(X))
    res = np.dot(res, y)

    return res

b0, b1 = coef(X, y)

# Calculando os valores previstos
Y = [b0 + b1 * i for i in X]

#  Visualização em gráfico
fig = go.Figure()
fig.add_trace(go.Scatter(x=X, y=y, mode='markers', name='dados'))
fig.add_trace(go.Scatter(x=X, y=Y, mode='lines', name='regressão linear'))

fig.update_layout(
    title='Relação entre sálario e anos de estudo',
    xaxis_title='Anos de estudo',
    yaxis_title='Salário'
)
fig.show()
```

## Conclusão

Embora simples, o conceito de regressão linear serve como base para diversos algoritmos de machine learning, compreender a regressão linear é o primeiro passo para entender como as máquinas aprendem padrões nos dados e tomam decisões baseadas neles.