---
title: "Regressão Linear: visualizando a relação entre valores"
description: "Conheça a base para entender como a IA faz previsões."
author: "André Pereira"
date: "11/10/2025"
date-modified: "11/16/2025"
categories:
    - machine learning
    - análise preditiva
    - IA
    - plotly
    - numpy
    - regressão linear
image: machine_learning.jpg
---

## O que é uma regressão linear?

A **regressão linear** é uma técnica estatística usada para modelar a relação entre uma variável dependente (ou resposta) e uma ou mais variáveis independentes (ou preditoras).

Ela permite **prever valores desconhecidos da variável** dependente com base nos valores conhecidos das variáveis independentes, assumindo que essa relação pode ser representada por uma equação linear.

Essa técnica é amplamente utilizada em *machine learning* e em análise de dados para fazer previsões e **identificar tendências** lineares entre variáveis.

Fonte: [AWS - O que é regressão linear?](https://aws.amazon.com/pt/what-is/linear-regression/)

## Como calcular a regressão linear?

A fórmula para a **regressão linear simples é** $Y = b_0 + b_1X$ onde:

* $X$: variável independente (valor usado para prever os resultados);
* $Y$: variável dependente (valor que queremos prever);
* $b_0$: intercepto, o valor de $Y$ quando $X = 0$.
* $b_1$: coeficiente angular (ou inclinação da reta), que indica a intensidade e direção da relação linear entre $X$ e $Y$.

A forma matricial da regressão linear é dada por: $b = (X^{T}X)^{-1}X^Ty$

onde $b$ contém os coeficientes $[b_0, b_1]$

## Exemplo: relação entre anos de estudo e salário

### 1. Extraindo dados

Neste exemplo vamos utilizar dois arquivos que terão os dados que necessitamos.

```txt

---- X.txt (Anos de estudo)
1.000119600075902
1.0189872184946
1.0236894585568583
1.0237422754454655
1.0237654179908648
....

---- y.txt (Salário)
1143.976585302664
2419.2561126222363
1447.1317609602766
334.15992825741625
1214.7229741184829
```

Vamos então extrair as informações dos arquivos e transformá-las para arrays do **NumPy**

```python
import numpy as np

# Lendo os arquivos
with open("X.txt", "r") as f:
    X = [float(i) for i in f.read().split("\n") if i != '']

with open("y.txt", "r") as f:
    y = [float(i) for i in f.read().split("\n") if i != '']

# Transformando em array NumPy
X = np.array(X)
y = np.array(y)
```

### 2. Ajustando os dados

Para calcular os coeficientes, precisamos adicionar uma coluna de 1s a X, que representa o intercepto da regressão.

```python

X = np.array([[1, i] for i in X])
```

### 3. Calculando os coeficientes

Aplicamos a fórmula matricial da regressão linear.

```python
res = np.dot(np.transpose(X), X)
res = np.dot(np.linalg.inv(res), np.transpose(X))
res = np.dot(res, y)

b0, b1 = res
```

### 4. Calculando os valores previstos

Com os coeficientes em mãos, podemos estimar os valores de **Y** (salário previsto):

```python
Y = [b0 + b1 * i for i in X[:, 1]]
```

### 5. Visualização

Para visualizarmos o nosso resultado utilizaremos o módulo *graph_objects* da biblioteca **Plotly**

```python
import plotly.graph_objects as go

#  Visualização em gráfico
fig = go.Figure()
fig.add_trace(go.Scatter(x=X, y=y, mode='markers', name='dados'))
fig.add_trace(go.Scatter(x=X, y=Y, mode='lines', name='regressão linear'))

fig.update_layout(
    title='Relação entre sálario e anos de estudo',
    xaxis_title='Anos de estudo',
    yaxis_title='Salário'
)

fig.show()
```

Após isso necessitamos apenas rodar o arquivo .py

```bash
python script.py
```

```{python}

#| label: plot_regressao
#| fig_cap: Gráfico com regressão linear.

import plotly.graph_objects as go
import numpy as np

# Lendo os arquivos
with open("X.txt", "r") as f:
    X = [float(i) for i in f.read().split("\n") if i != '']

with open("y.txt", "r") as f:
    y = [float(i) for i in f.read().split("\n") if i != '']

# Transformando em array NumPy
X = np.array(X)
y = np.array(y)

# Calculando os coeficientes
def coef(X, y):
    X = np.array([[1, i] for i in X])
    res = np.dot(np.transpose(X), X)
    res = np.dot(np.linalg.inv(res), np.transpose(X))
    res = np.dot(res, y)

    return res

b0, b1 = coef(X, y)

# Calculando os valores previstos
Y = [b0 + b1 * i for i in X]

#  Visualização em gráfico
fig = go.Figure()
fig.add_trace(go.Scatter(x=X, y=y, mode='markers', name='dados'))
fig.add_trace(go.Scatter(x=X, y=Y, mode='lines', name='regressão linear'))

fig.update_layout(
    title='Relação entre sálario e anos de estudo',
    xaxis_title='Anos de estudo',
    yaxis_title='Salário'
)

fig.show()
```

## Conclusão

Embora simples, o conceito de regressão linear serve como base para diversos algoritmos de machine learning, compreender a regressão linear é o primeiro passo para entender como as máquinas aprendem padrões nos dados e tomam decisões baseadas neles.